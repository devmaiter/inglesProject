<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üî• HACKER VOCABULARY QUIZ</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Courier New', monospace;
      background:linear-gradient(135deg,#0a0a0a 0%,#1a1a1a 50%,#0d4f3c 100%);
      min-height:100vh; display:flex; justify-content:center; align-items:center;
      padding:20px; color:#00ff00; position:relative; overflow-x:hidden;
    }
    body::before {
      content:''; position:fixed; inset:0;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(0,255,0,.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(0,255,0,.06) 0%, transparent 45%);
      pointer-events:none;
    }
    .container { width:100%; max-width:980px; background:rgba(0,0,0,.55); border:1px solid #0f7; border-radius:16px; box-shadow:0 0 30px rgba(0,255,140,.15); padding:28px; backdrop-filter: blur(3px); }
    .title { display:flex; gap:10px; align-items:center; margin-bottom:8px; font-size:26px; letter-spacing:1px; }
    .sub { color:#7bffbf; font-size:14px; opacity:.9; margin-bottom:12px; }
    .panel { display:grid; gap:16px; grid-template-columns: 1fr; margin-top:10px; }
    .card { border:1px solid #0f7; border-radius:14px; padding:18px; background: rgba(0,0,0,.35); }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    input[type="text"]{ flex:1; min-width:220px; padding:12px 14px; border-radius:10px; border:1px solid #0f7; background:#0b130f; color:#b8ffda; outline:none; }
    button { padding:12px 16px; border-radius:10px; border:1px solid #0f7; background:#062; color:#c9ffdf; cursor:pointer; font-weight:700; transition: transform .07s ease, box-shadow .2s ease; }
    button:hover { box-shadow:0 0 12px rgba(0,255,140,.35); }
    button:active { transform:scale(.98); }
    .word { font-size:28px; color:#a2ffcf; font-weight:700; letter-spacing:.5px; }
    .muted { color:#77e9b6a8; font-size:13px }
    .status { font-size:15px; margin-top:8px; min-height:22px; }
    .ok { color:#7eff9a }
    .bad { color:#ff7676 }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:10px; margin-top:8px; }
    .mcOpt { border:1px solid #0f7; padding:12px 16px; border-radius:10px; background:#072; color:#d1ffe9; font-weight:700; cursor:pointer; }
    .footer { margin-top:16px; display:flex; gap:8px; flex-wrap:wrap; align-items:center; color:#7bffbf }
    .kbd { border:1px solid #0f7; padding:2px 6px; border-radius:6px; background:#072; color:#d1ffe9; font-weight:700 }
    .counter { color:#a0ffd6; font-size:14px }
    .sep { opacity:.35; margin:0 6px }
    .small { font-size:12px; opacity:.8 }
    .list { max-height:220px; overflow:auto; border:1px solid #0f7; border-radius:12px; padding:10px; background:rgba(0,0,0,.25) }
    .list-item { display:flex; justify-content:space-between; gap:12px; padding:6px 4px; border-bottom:1px dashed #0f7; font-size:14px; }
    .list-item:last-child { border-bottom:none }
    .left { color:#c6ffe4 }
    .right { color:#86ffc6 }
    .hint { font-size:13px; color:#8bffd0 }
    .hidden { display:none }
    .score { margin-left:auto; font-size:14px; color:#a0ffd6; display:flex; gap:10px; align-items:center; }
    .pill { border:1px solid #0f7; padding:4px 8px; border-radius:999px; background:#072; }
    .end { text-align:center; padding:20px 8px; }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">üî• HACKER VOCABULARY QUIZ <span class="sep">|</span> <span class="small">A2 practice</span></div>
    <div class="sub">Modo estudio y quiz r√°pido para tu lista personalizada.</div>

    <div class="panel">
      <div class="card">
        <div class="row">
          <label class="muted">Modo:</label>
          <button id="btnToggleMode">Cambiar modo</button>
          <button id="btnToggleType">Cambiar tipo</button>
          <div class="score">
            <span class="pill">‚úÖ <span id="good">0</span></span>
            <span class="pill">‚ùå <span id="bad">0</span></span>
            <span class="pill">Pendientes: <span id="left">0</span></span>
          </div>
        </div>
      </div>

      <div class="card">
        <div id="prompt" class="word">‚Äî</div>
        <div id="hint" class="hint muted"></div>

        <div id="openBlock" class="row" style="margin-top:10px;">
          <input id="answer" type="text" placeholder="Escribe tu respuesta aqu√≠‚Ä¶" autocomplete="off"/>
          <button id="btnShow">üëÄ Ver palabra</button>
        </div>

        <div id="mcBlock" class="grid hidden"></div>

        <div id="status" class="status"></div>
        <div class="footer">
          <span class="counter" id="counter">1 / 1</span>
          <span class="sep">‚Ä¢</span>
          <span class="muted">Atajos:</span>
          <span class="kbd">Enter</span> mostrar y pasar
          <button id="btnRestart" class="hidden">Reiniciar</button>
        </div>
      </div>

      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <div class="muted">Lista completa</div>
          <button id="btnToggleList">Mostrar/Ocultar</button>
        </div>
        <div id="listWrap" class="list hidden"></div>
      </div>
    </div>
  </div>

  <script>
    // ====== Datos ======
    const vocabulario = [
      {"word": "Pride", "meaning": "orgullo"},
      {"word": "Mine", "meaning": "m√≠o / mina"},
      {"word": "Creeping", "meaning": "arrastr√°ndose / avanzando lentamente"},
      {"word": "Peanut", "meaning": "man√≠ / cacahuate"},
      {"word": "Butter", "meaning": "mantequilla"},
      {"word": "Guess", "meaning": "adivinar / suponer"},
      {"word": "Fools", "meaning": "tontos"},
      {"word": "Snowflake", "meaning": "copo de nieve"},
      {"word": "Wind", "meaning": "viento / enrollar"},
      {"word": "Glimpse", "meaning": "vistazo"},
      {"word": "Heatwaves", "meaning": "olas de calor"},
      {"word": "Tight", "meaning": "ajustado / apretado"},
      {"word": "Alright", "meaning": "est√° bien / ok"},
      {"word": "Naked", "meaning": "desnudo"},
      {"word": "Silhouettes", "meaning": "siluetas"},
      {"word": "Shall", "meaning": "(futuro formal / sugerencia)"},
      {"word": "Sea's", "meaning": "del mar"},
      {"word": "Eastern", "meaning": "oriental / del este"},
      {"word": "Journey", "meaning": "viaje"},
      {"word": "Rings", "meaning": "anillos / suena"},
      {"word": "Buzz", "meaning": "zumbido"},
      {"word": "Heat", "meaning": "calor"},
      {"word": "Disguise", "meaning": "disfraz / disfrazar"},
      {"word": "Dime", "meaning": "moneda de diez centavos (EE.UU.)"},
      {"word": "Jukebox", "meaning": "rockola"},
      {"word": "Baggies", "meaning": "pantalones anchos (slang)"},
      {"word": "Bushy", "meaning": "espeso / frondoso"},
      {"word": "Blond", "meaning": "rubio"},
      {"word": "Hairdo", "meaning": "peinado"},
      {"word": "Trestles", "meaning": "caballetes"},
      {"word": "Teaser", "meaning": "avance / adelanto"},
      {"word": "Holy", "meaning": "santo / sagrado"},
      {"word": "Kneejoker", "meaning": "reacci√≥n autom√°tica (knee-jerk)"},
      {"word": "Shoeshine", "meaning": "lustrado de zapatos"},
      {"word": "ToeJam", "meaning": "mugre entre los dedos (slang)"},
      {"word": "Walrus", "meaning": "morsa"},
      {"word": "Sideboard", "meaning": "aparador (mueble)"},
      {"word": "Spinal", "meaning": "espinal / de la columna"},
      {"word": "Cracker", "meaning": "galleta salada / petardo"},
      {"word": "Grass", "meaning": "c√©sped / hierba"},
      {"word": "Frowning", "meaning": "frunciendo el ce√±o"},
      {"word": "Blind", "meaning": "ciego"},
      {"word": "Sight", "meaning": "vista / paisaje"},
      {"word": "Chart", "meaning": "gr√°fico / tabla"},
      {"word": "Sheets", "meaning": "s√°banas / hojas"},
      {"word": "Alibi", "meaning": "coartada"},
      {"word": "Blame", "meaning": "culpa / culpar"},
      {"word": "Chains", "meaning": "cadenas"},
      {"word": "Docks", "meaning": "muelles"},
      {"word": "Strike", "meaning": "golpear / huelga"},
      {"word": "Brings", "meaning": "trae"},
      {"word": "Prayer", "meaning": "oraci√≥n / rezo"},
      {"word": "Swear", "meaning": "jurar / maldecir"},
      {"word": "Slipped", "meaning": "resbal√≥"},
      {"word": "Wander", "meaning": "deambular / vagar"},
      {"word": "Ill", "meaning": "enfermo / mal"},
      {"word": "Newcomers", "meaning": "reci√©n llegados"},
      {"word": "Loud", "meaning": "ruidoso"},
      {"word": "Gather", "meaning": "reunir / recoger"},
      {"word": "Clay", "meaning": "arcilla"},
      {"word": "Pit", "meaning": "pozo / fosa"},
      {"word": "Envelope", "meaning": "sobre (de carta)"},
      {"word": "Gunpowder", "meaning": "p√≥lvora"},
      {"word": "Toss", "meaning": "lanzar / arrojar"},
      {"word": "Cheers", "meaning": "salud / brindis"},
      {"word": "Beverage", "meaning": "bebida"},
      {"word": "Truly", "meaning": "realmente"},
      {"word": "Proves", "meaning": "demuestra / prueba"},
      {"word": "Mishaps", "meaning": "contratiempos"},
      {"word": "Land", "meaning": "tierra / aterrizar"},
      {"word": "Treasure", "meaning": "tesoro"},
      {"word": "Candler", "meaning": "candelero"},
      {"word": "Shifted", "meaning": "cambi√≥ / movi√≥"},
      {"word": "Clever", "meaning": "listo / ingenioso"},
      {"word": "Contour", "meaning": "contorno"},
      {"word": "Remains", "meaning": "restos / permanece"}
    ];

    // ====== Utils ======
    const $ = (q) => document.querySelector(q);
    const $$ = (q) => Array.from(document.querySelectorAll(q));
    const rand = (n) => Math.floor(Math.random()*n);
    const shuffle = (arr) => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);
    const normalize = (s) => (s||'').toString().trim().toLowerCase();

    // ====== Estado ======
    let pool = [];       // √≠ndices pendientes (se vac√≠a cuando terminas)
    let pointer = 0;     // posici√≥n dentro de pool
    let current = null;  // objeto actual
    let idx = -1;        // √≠ndice actual
    let mode = 'en-es';  // en-es | es-en | spell
    let questionType = 'open'; // open | mc
    let good = 0, bad = 0;

    // ====== Elementos UI ======
    const promptEl = $('#prompt');
    const hintEl = $('#hint');
    const answerEl = $('#answer');
    const statusEl = $('#status');
    const counterEl = $('#counter');
    const mcBlock = $('#mcBlock');
    const openBlock = $('#openBlock');
    const listWrap = $('#listWrap');
    const toggleListBtn = $('#btnToggleList');
    const showBtn = $('#btnShow');
    const typeBtn = $('#btnToggleType');
    const modeBtn = $('#btnToggleMode');
    const goodEl = $('#good');
    const badEl = $('#bad');
    const leftEl = $('#left');
    const restartBtn = $('#btnRestart');

    const ADVANCE_DELAY = 700;

    // ====== Inicializaci√≥n ======
    function reset(){
      pool = shuffle([...Array(vocabulario.length).keys()]);
      pointer = 0; good = 0; bad = 0;
      updateBadGoodLeft();
      setPrompt();
      restartBtn.classList.add('hidden');
      openBlock.classList.remove('hidden');
      mcBlock.classList.add('hidden');
      questionType = 'open';
      statusEl.textContent = '';
      statusEl.className = 'status';
    }

    function updateBadGoodLeft(){
      goodEl.textContent = good;
      badEl.textContent = bad;
      leftEl.textContent = pool.length;
      const pos = pool.length ? (pointer % pool.length) : 0;
      counterEl.textContent = `${pool.length ? pos+1 : 0} / ${vocabulario.length}`;
    }

    function getCurrent(){
      if (!pool.length){ endQuiz(); return null; }
      idx = pool[pointer];
      current = vocabulario[idx];
      return current;
    }

    function setPrompt(){
      const cur = getCurrent();
      if (!cur) return;
      statusEl.textContent = '';
      statusEl.className = 'status';
      answerEl.value = '';

      if (mode === 'en-es') { promptEl.textContent = cur.word; hintEl.textContent = 'Traduce al espa√±ol'; }
      else if (mode === 'es-en') { promptEl.textContent = cur.meaning.replace(/ *\/ */g, ' / '); hintEl.textContent = 'Traduce al ingl√©s'; }
      else { promptEl.textContent = cur.word; hintEl.textContent = 'Deletrea la palabra en ingl√©s'; }

      renderQuestionType();
      updateBadGoodLeft();
      answerEl.focus();
    }

    function renderQuestionType(){
      if (questionType === 'open') {
        mcBlock.classList.add('hidden');
        openBlock.classList.remove('hidden');
      } else {
        openBlock.classList.add('hidden');
        mcBlock.classList.remove('hidden');
        renderMC();
      }
    }

    function renderList(){
      listWrap.innerHTML = vocabulario.map(v => `<div class="list-item"><span class="left">${v.word}</span><span class="right">${v.meaning}</span></div>`).join('');
    }

    // ====== L√≥gica de evaluaci√≥n (estricta) ======
    const strip = (s)=> s.replace(/[.,;:!?¬°¬ø"'`()\[\]{}]/g,'').replace(/\s+/g,' ').trim();
    const norm = (s)=> normalize(strip(s));

    function explodeVariants(text){
      const noParen = text.replace(/\([^)]*\)/g,'');
      const parts = noParen.split(/\s*[\/;,]\s*/g).map(x=>x.trim()).filter(Boolean);
      return parts.length ? parts : [text.trim()];
    }

    function getCorrectAnswerText(){
      if (mode === 'en-es') return current.meaning;
      if (mode === 'es-en' || mode === 'spell') return current.word;
    }

    function isCorrect(user){
      const userN = norm(user);
      if (!userN) return false;
      if (mode === 'en-es'){
        const vars = explodeVariants(getCorrectAnswerText());
        return vars.some(v => userN === norm(v));
      } else if (mode === 'es-en'){
        const target = norm(current.word);
        return userN === target || userN === ('to '+target);
      } else { // spell
        const target = norm(current.word);
        return userN === target;
      }
    }

    // ====== Avance con repetici√≥n de fallos ======
    function advance(correct){
      if (!pool.length) return endQuiz();
      if (correct){
        good++;
        // eliminar definitivamente el √≠ndice actual
        pool.splice(pointer,1);
        if (pointer >= pool.length) pointer = 0;
      } else {
        bad++;
        // mover el actual al final para que se repita
        const [cur] = pool.splice(pointer,1);
        pool.push(cur);
        if (pointer >= pool.length) pointer = 0;
      }
      updateBadGoodLeft();
      if (!pool.length) return endQuiz();
      setTimeout(setPrompt, ADVANCE_DELAY);
    }

    function endQuiz(){
      // Pantalla final con resumen
      promptEl.innerHTML = 'üéâ ¬°Terminaste el quiz!';
      hintEl.innerHTML = `Correctas: <b>${good}</b> &nbsp; ‚Ä¢ &nbsp; Incorrectas: <b>${bad}</b>`;
      statusEl.textContent = '';
      openBlock.classList.add('hidden');
      mcBlock.classList.add('hidden');
      restartBtn.classList.remove('hidden');
    }

    // ====== M√∫ltiple opci√≥n ======
    function renderMC(){
      if (!current) return;
      // 3 distractores + 1 correcta
      const others = shuffle(vocabulario.map((v,i)=>({v,i})).filter(x=>x.i!==idx)).slice(0,3).map(x=>x.v);
      const options = shuffle([current, ...others]);
      mcBlock.innerHTML = options.map(o=>`<button class="mcOpt">${mode==='en-es'?o.meaning:o.word}</button>`).join('');
      $$('.mcOpt').forEach(btn=>{
        btn.onclick = ()=>{
          const val = btn.textContent;
          const isOk = (mode==='en-es') ? (norm(val)===norm(current.meaning)) : (norm(val)===norm(current.word));
          setStatus(isOk);
          advance(isOk);
        };
      });
    }

    function setStatus(ok){
      if (ok){ statusEl.textContent = '‚úÖ ¬°Correcto!'; statusEl.className = 'status ok'; }
      else { statusEl.textContent = `‚ùå Incorrecto. Respuesta: ${getCorrectAnswerText()}`; statusEl.className = 'status bad'; }
    }

    // ====== Eventos ======
    document.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter'){
        // Mostrar respuesta y contar como incorrecta
        if (pool.length){ setStatus(false); advance(false); }
      }
    });

    answerEl.addEventListener('input', ()=>{
      const val = answerEl.value;
      if (!pool.length) return;
      if (isCorrect(val)){
        setStatus(true);
        advance(true);
      } else {
        statusEl.textContent = '';
        statusEl.className = 'status';
      }
    });

    showBtn.addEventListener('click', ()=>{ if (pool.length){ setStatus(false); advance(false); } });

    typeBtn.addEventListener('click', ()=>{ questionType = (questionType==='open')? 'mc':'open'; renderQuestionType(); });

    modeBtn.addEventListener('click', ()=>{
      mode = (mode==='en-es')? 'es-en' : (mode==='es-en'? 'spell':'en-es');
      setPrompt();
    });

    toggleListBtn.addEventListener('click', ()=>{ listWrap.classList.toggle('hidden'); });

    restartBtn.addEventListener('click', reset);

    // ====== Start ======
    renderList();
    reset();
  </script>
</body>
</html>
