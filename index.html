<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ðŸ”¥ HACKER VOCABULARY QUIZ</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Courier New', monospace;
      background:linear-gradient(135deg,#0a0a0a 0%,#1a1a1a 50%,#0d4f3c 100%);
      min-height:100vh; display:flex; justify-content:center; align-items:center;
      padding:20px; color:#00ff00; position:relative; overflow-x:hidden;
    }
    body::before {
      content:''; position:fixed; inset:0;
      background-image:
        radial-gradient(circle at 20% 20%, rgba(0,255,0,.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(0,255,0,.06) 0%, transparent 45%);
      pointer-events:none;
    }
    .container { width:100%; max-width:950px; background:rgba(0,0,0,.55); border:1px solid #0f7; border-radius:16px; box-shadow:0 0 30px rgba(0,255,140,.15); padding:28px; backdrop-filter: blur(3px); }
    .title { display:flex; gap:10px; align-items:center; margin-bottom:12px; font-size:26px; letter-spacing:1px; }
    .sub { color:#7bffbf; font-size:14px; opacity:.9; margin-bottom:18px; }
    .panel { display:grid; gap:16px; grid-template-columns: 1fr; margin-top:10px; }
    .card { border:1px solid #0f7; border-radius:14px; padding:18px; background: rgba(0,0,0,.35); }
    .row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    input[type="text"]{ flex:1; min-width:220px; padding:12px 14px; border-radius:10px; border:1px solid #0f7; background:#0b130f; color:#b8ffda; outline:none; }
    button { padding:12px 16px; border-radius:10px; border:1px solid #0f7; background:#062; color:#c9ffdf; cursor:pointer; font-weight:700; transition: transform .07s ease, box-shadow .2s ease; }
    button:hover { box-shadow:0 0 12px rgba(0,255,140,.35); }
    button:active { transform:scale(.98); }
    .word { font-size:28px; color:#a2ffcf; font-weight:700; letter-spacing:.5px; }
    .muted { color:#77e9b6a8; font-size:13px }
    .status { font-size:15px; margin-top:8px; min-height:22px; }
    .ok { color:#7eff9a }
    .bad { color:#ff7676 }
    .grid { display:grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap:10px; margin-top:8px; }
    .mcOpt { border:1px solid #0f7; padding:12px 16px; border-radius:10px; background:#072; color:#d1ffe9; font-weight:700; cursor:pointer; }
    .footer { margin-top:16px; display:flex; gap:8px; flex-wrap:wrap; align-items:center; color:#7bffbf }
    .kbd { border:1px solid #0f7; padding:2px 6px; border-radius:6px; background:#072; color:#d1ffe9; font-weight:700 }
    .counter { color:#a0ffd6; font-size:14px }
    .sep { opacity:.35; margin:0 6px }
    .small { font-size:12px; opacity:.8 }
    .list { max-height:220px; overflow:auto; border:1px solid #0f7; border-radius:12px; padding:10px; background:rgba(0,0,0,.25) }
    .list-item { display:flex; justify-content:space-between; gap:12px; padding:6px 4px; border-bottom:1px dashed #0f7; font-size:14px; }
    .list-item:last-child { border-bottom:none }
    .left { color:#c6ffe4 }
    .right { color:#86ffc6 }
    .hint { font-size:13px; color:#8bffd0 }
    .hidden { display:none }
  </style>
</head>
<body>
  <div class="container">
    <div class="title">ðŸ”¥ HACKER VOCABULARY QUIZ <span class="sep">|</span> <span class="small">A2 practice</span></div>
    <div class="sub">Modo estudio y quiz rÃ¡pido para tu lista personalizada.</div>

    <!-- CONTROLES -->
    <div class="panel">
      <div class="card">
        <div class="row">
          <label class="muted">Modo:</label>
          <select id="mode">
            <option value="en-es">EN âžœ ES (traduce al espaÃ±ol)</option>
            <option value="es-en">ES âžœ EN (traduce al inglÃ©s)</option>
            <option value="spell">SPELL (deletrea en inglÃ©s)</option>
          </select>

          <span class="muted">Tipo de pregunta:</span>
          <button id="btnToggleType">Tipo: Respuesta abierta</button>
        </div>
      </div>

      <!-- TARJETA DE PREGUNTA -->
      <div class="card">
        <div id="prompt" class="word">â€”</div>
        <div id="hint" class="hint muted"></div>

        <!-- Respuesta abierta -->
        <div id="openBlock" class="row" style="margin-top:10px;">
          <input id="answer" type="text" placeholder="Escribe tu respuesta aquÃ­â€¦" autocomplete="off"/>
          <button id="btnShow">ðŸ‘€ Ver palabra</button>
        </div>

        <!-- MÃºltiple opciÃ³n -->
        <div id="mcBlock" class="grid hidden"></div>

        <div id="status" class="status"></div>
        <div class="footer">
          <span class="counter" id="counter">1 / 1</span>
          <span class="sep">â€¢</span>
          <span class="muted">Atajos:</span>
          <span class="kbd">Enter</span> mostrar y pasar
        </div>
      </div>

      <!-- LISTADO -->
      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <div class="muted">Lista completa</div>
          <button id="btnToggleList">Mostrar/Ocultar</button>
        </div>
        <div id="listWrap" class="list hidden"></div>
      </div>
    </div>
  </div>

  <script>
    // =========================
    //   LISTA DE VOCABULARIO
    // =========================
    const vocabulario = [
      {"word": "Pride", "meaning": "orgullo"},
      {"word": "Mine", "meaning": "mÃ­o / mina"},
      {"word": "Creeping", "meaning": "arrastrÃ¡ndose / avanzando lentamente"},
      {"word": "Peanut", "meaning": "manÃ­ / cacahuate"},
      {"word": "Butter", "meaning": "mantequilla"},
      {"word": "Guess", "meaning": "adivinar / suponer"},
      {"word": "Fools", "meaning": "tontos"},
      {"word": "Snowflake", "meaning": "copo de nieve"},
      {"word": "Wind", "meaning": "viento / enrollar"},
      {"word": "Glimpse", "meaning": "vistazo"},
      {"word": "Heatwaves", "meaning": "olas de calor"},
      {"word": "Tight", "meaning": "ajustado / apretado"},
      {"word": "Alright", "meaning": "estÃ¡ bien / ok"},
      {"word": "Naked", "meaning": "desnudo"},
      {"word": "Silhouettes", "meaning": "siluetas"},
      {"word": "Shall", "meaning": "(futuro formal / sugerencia)"},
      {"word": "Sea's", "meaning": "del mar"},
      {"word": "Eastern", "meaning": "oriental / del este"},
      {"word": "Journey", "meaning": "viaje"},
      {"word": "Rings", "meaning": "anillos / suena"},
      {"word": "Buzz", "meaning": "zumbido"},
      {"word": "Heat", "meaning": "calor"},
      {"word": "Disguise", "meaning": "disfraz / disfrazar"},
      {"word": "Dime", "meaning": "moneda de diez centavos (EE.UU.)"},
      {"word": "Jukebox", "meaning": "rockola"},
      {"word": "Baggies", "meaning": "pantalones anchos (slang)"},
      {"word": "Bushy", "meaning": "espeso / frondoso"},
      {"word": "Blond", "meaning": "rubio"},
      {"word": "Hairdo", "meaning": "peinado"},
      {"word": "Trestles", "meaning": "caballetes"},
      {"word": "Teaser", "meaning": "avance / adelanto"},
      {"word": "Holy", "meaning": "santo / sagrado"},
      {"word": "Kneejoker", "meaning": "reacciÃ³n automÃ¡tica (knee-jerk)"},
      {"word": "Shoeshine", "meaning": "lustrado de zapatos"},
      {"word": "ToeJam", "meaning": "mugre entre los dedos (slang)"},
      {"word": "Walrus", "meaning": "morsa"},
      {"word": "Sideboard", "meaning": "aparador (mueble)"},
      {"word": "Spinal", "meaning": "espinal / de la columna"},
      {"word": "Cracker", "meaning": "galleta salada / petardo"},
      {"word": "Grass", "meaning": "cÃ©sped / hierba"},
      {"word": "Frowning", "meaning": "frunciendo el ceÃ±o"},
      {"word": "Blind", "meaning": "ciego"},
      {"word": "Sight", "meaning": "vista / paisaje"},
      {"word": "Chart", "meaning": "grÃ¡fico / tabla"},
      {"word": "Sheets", "meaning": "sÃ¡banas / hojas"},
      {"word": "Alibi", "meaning": "coartada"},
      {"word": "Blame", "meaning": "culpa / culpar"},
      {"word": "Chains", "meaning": "cadenas"},
      {"word": "Docks", "meaning": "muelles"},
      {"word": "Strike", "meaning": "golpear / huelga"},
      {"word": "Brings", "meaning": "trae"},
      {"word": "Prayer", "meaning": "oraciÃ³n / rezo"},
      {"word": "Swear", "meaning": "jurar / maldecir"},
      {"word": "Slipped", "meaning": "resbalÃ³"},
      {"word": "Wander", "meaning": "deambular / vagar"},
      {"word": "Ill", "meaning": "enfermo / mal"},
      {"word": "Newcomers", "meaning": "reciÃ©n llegados"},
      {"word": "Loud", "meaning": "ruidoso"},
      {"word": "Gather", "meaning": "reunir / recoger"},
      {"word": "Clay", "meaning": "arcilla"},
      {"word": "Pit", "meaning": "pozo / fosa"},
      {"word": "Envelope", "meaning": "sobre (de carta)"},
      {"word": "Gunpowder", "meaning": "pÃ³lvora"},
      {"word": "Toss", "meaning": "lanzar / arrojar"},
      {"word": "Cheers", "meaning": "salud / brindis"},
      {"word": "Beverage", "meaning": "bebida"},
      {"word": "Truly", "meaning": "realmente"},
      {"word": "Proves", "meaning": "demuestra / prueba"},
      {"word": "Mishaps", "meaning": "contratiempos"},
      {"word": "Land", "meaning": "tierra / aterrizar"},
      {"word": "Treasure", "meaning": "tesoro"},
      {"word": "Candler", "meaning": "candelero"},
      {"word": "Shifted", "meaning": "cambiÃ³ / moviÃ³"},
      {"word": "Clever", "meaning": "listo / ingenioso"},
      {"word": "Contour", "meaning": "contorno"},
      {"word": "Remains", "meaning": "restos / permanece"}
    ];

    // ====== UTILIDADES ======
    const $ = (q) => document.querySelector(q);
    const $$ = (q) => Array.from(document.querySelectorAll(q));
    const rand = (n) => Math.floor(Math.random()*n);
    const shuffle = (arr) => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);

    // ====== NORMALIZACIÃ“N / SINÃ“NIMOS ======
    const normalize = (s) => (s||'').toString().trim().toLowerCase()
      .replace(/\s+/g,' ')
      .normalize('NFD').replace(/[\u0300-\u036f]/g,'');

    function stripPunctuation(s){
      return s.replace(/[.,;:!?Â¡Â¿"'`()\[\]{}]/g,'').replace(/\s+/g,' ').trim();
    }

    // Explota sinÃ³nimos en significado ES: separadores / , ; y parÃ©ntesis
    function explodeVariants(text){
      const noParen = text.replace(/\([^)]*\)/g,'');
      const parts = noParen.split(/\s*[\/;,]\s*/g).map(x=>x.trim()).filter(Boolean);
      if (!parts.length) parts.push(text.trim());
      const set = new Set();
      const out = [];
      for (const p of parts){
        const n = normalize(stripPunctuation(p));
        if (!set.has(n)) { set.add(n); out.push(p); }
      }
      return out;
    }

    // ====== ESTADO DEL QUIZ (ORDEN ALEATORIO SIN REPETIR) ======
    let order = [];
    let pointer = 0;
    function makeOrder(){ order = shuffle([...Array(vocabulario.length).keys()]); pointer = 0; }
    function getCurrentIndex(){ if (pointer >= order.length) makeOrder(); return order[pointer]; }
    function goNext(){ pointer++; if (pointer >= order.length) makeOrder(); }

    // Estado de pregunta
    let idx = 0;
    let current = null;

    // Elementos
    const modeSel = $('#mode');
    const typeBtn = $('#btnToggleType');
    const promptEl = $('#prompt');
    const hintEl = $('#hint');
    const answerEl = $('#answer');
    const showBtn = $('#btnShow');
    const statusEl = $('#status');
    const counterEl = $('#counter');
    const mcBlock = $('#mcBlock');
    const openBlock = $('#openBlock');
    const listWrap = $('#listWrap');
    const toggleListBtn = $('#btnToggleList');

    // Estado del tipo de pregunta (open/mc)
    let questionType = 'open';
    const ADVANCE_DELAY = 800; // ms

    function updateCounter(){
      const pos = pointer % order.length;
      counterEl.textContent = `${pos+1} / ${vocabulario.length}`;
    }

    function setPrompt() {
      idx = getCurrentIndex();
      current = vocabulario[idx];
      statusEl.textContent = '';
      statusEl.className = 'status';
      answerEl.value = '';

      const mode = modeSel.value;
      if (mode === 'en-es') {
        promptEl.textContent = current.word;
        hintEl.textContent = 'Traduce al espaÃ±ol';
      } else if (mode === 'es-en') {
        promptEl.textContent = current.meaning.replace(/ *\/ */g, ' / ');
        hintEl.textContent = 'Traduce al inglÃ©s';
      } else {
        promptEl.textContent = current.word;
        hintEl.textContent = 'Deletrea la palabra en inglÃ©s';
      }

      renderQuestionType();
      updateCounter();
      answerEl.focus();
    }

    function renderList(){
      listWrap.innerHTML = vocabulario.map(v =>
        `<div class="list-item"><span class="left">${v.word}</span><span class="right">${v.meaning}</span></div>`
      ).join('');
    }

    function renderQuestionType(){
      if (questionType === 'open') {
        mcBlock.classList.add('hidden');
        openBlock.classList.remove('hidden');
        typeBtn.textContent = 'Tipo: Respuesta abierta';
      } else {
        openBlock.classList.add('hidden');
        mcBlock.classList.remove('hidden');
        typeBtn.textContent = 'Tipo: MÃºltiple opciÃ³n';
        renderMC();
      }
    }

    function getCorrectAnswerText(){
      const mode = modeSel.value;
      if (mode === 'en-es') return current.meaning;
      if (mode === 'es-en' || mode === 'spell') return current.word;
    }

    // ComprobaciÃ³n estricta (sin typos)
    function isCorrect(user){
      const mode = modeSel.value;
      const userN = normalize(stripPunctuation(user));
      if (!userN) return false;

      if (mode === 'en-es'){
        const variants = explodeVariants(getCorrectAnswerText());
        return variants.some(v => userN === normalize(stripPunctuation(v)));
      } else if (mode === 'es-en'){
        const target = normalize(stripPunctuation(current.word));
        return userN === target || userN === ('to ' + target); // permitir 'to ' opcional
      } else { // spell
        const target = normalize(stripPunctuation(current.word));
        return userN === target; // deletreo exacto
      }
    }

    function setStatus(ok, correct){
      if (ok){ statusEl.textContent = 'âœ… Â¡Correcto!'; statusEl.className = 'status ok'; }
      else { statusEl.textContent = `âŒ Incorrecto. Respuesta: ${correct}`; statusEl.className = 'status bad'; }
    }

    function autoAdvance(){ setTimeout(()=>{ goNext(); setPrompt(); }, ADVANCE_DELAY); }

    // ====== OPCIONES (MÃšLTIPLE OPCIÃ“N) ======
    function scoreSimilarity(a, b){
      if (!a || !b) return 0;
      const na = normalize(a), nb = normalize(b);
      const sameFirst = na[0] === nb[0] ? 0.15 : 0;
      const lenDiff = Math.abs(na.length - nb.length);
      const lenScore = Math.max(0, 0.25 - (lenDiff*0.04));
      const setA = new Set(na);
      const setB = new Set(nb);
      const inter = new Set([...setA].filter(x=>setB.has(x))).size;
      const uni = new Set([...setA, ...setB]).size || 1;
      const jac = inter/uni;
      return sameFirst + lenScore + jac * 0.7;
    }

    function pickDistractors(correctText, mode, k=3){
      const pool = vocabulario
        .map(v => mode === 'en-es' ? v.meaning : v.word)
        .filter(txt => normalize(txt) !== normalize(correctText));
      const ranked = pool.map(txt => ({ txt, s: scoreSimilarity(correctText, txt) }))
                         .sort((a,b)=> b.s - a.s);
      const selected = [];
      const used = new Set([normalize(correctText)]);
      for (const r of ranked){
        const key = normalize(r.txt);
        if (used.has(key)) continue;
        selected.push(r.txt);
        used.add(key);
        if (selected.length >= k) break;
      }
      while (selected.length < k){
        const r = pool[rand(pool.length)];
        const key = normalize(r);
        if (!used.has(key)) { selected.push(r); used.add(key); }
      }
      return selected;
    }

    function renderMC(){
      const mode = modeSel.value;
      const correct = getCorrectAnswerText();
      const distractors = pickDistractors(correct, mode, 3);
      const options = shuffle([correct, ...distractors]);

      mcBlock.innerHTML = options.map(opt => `<button class="mcOpt">${opt}</button>`).join('');

      $$('.mcOpt').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const ok = normalize(btn.textContent) === normalize(correct);
          setStatus(ok, correct);
          autoAdvance();
        });
      });
    }

    // ====== EVENTOS ======
    modeSel.addEventListener('change', setPrompt);
    typeBtn.addEventListener('click', ()=>{
      questionType = (questionType === 'open') ? 'mc' : 'open';
      renderQuestionType();
    });
    toggleListBtn.addEventListener('click', ()=>{ listWrap.classList.toggle('hidden'); });

    // Ver palabra
    showBtn.addEventListener('click', ()=>{
      setStatus(false, getCorrectAnswerText());
      autoAdvance();
    });

    // Input reactivo: evalÃºa en vivo y avanza cuando es correcto
    answerEl.addEventListener('input', ()=>{
      const val = answerEl.value;
      if (isCorrect(val)){
        setStatus(true, getCorrectAnswerText());
        autoAdvance();
      } else {
        statusEl.textContent = '';
        statusEl.className = 'status';
      }
    });

    // ENTER: si aÃºn no es correcto, muestra soluciÃ³n y avanza
    document.addEventListener('keydown', (e)=>{
      if (e.key === 'Enter'){
        const val = answerEl.value;
        if (!isCorrect(val)){ setStatus(false, getCorrectAnswerText()); }
        autoAdvance();
      }
    });

    // Init
    renderList();
    makeOrder();
    setPrompt();
  </script>
</body>
</html>
